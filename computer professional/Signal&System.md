# Signal & System

## Signals
- 正弦信号
- 单位脉冲信号 & 阶跃信号
- 复指数信号

## 单位脉冲函数
离散较简单：
$$
    \delta[n] = \begin{cases}
        1, n = 0\\
        0, n \ne 0
    \end{cases}
$$

连续情况较不直观：
$$
    规定\delta(t)满足如下性质：\\
    \delta(t) = 0, t \ne 0\\
    \int_{-\infty}^{\infty} \delta(t) dt = 0
$$

$\delta(t)$是奇异函数，实际上没有办法说清楚$\delta(0)$的是多少

筛选性质：

单位脉冲性质意味着对函数值的“采样”（这也是在单位脉冲函数在信号处理中广泛应用的根本原因）

## System
实际上一个*系统*在数学上可以表示为一个*泛函*

### System Attribute
- **线性/非线性**
  - 判定：
  $$
    设\mathcal{J}表示一线性系统，则：\\
    \mathcal{J}(cx(t)) = c\mathcal{J}(x(t))\\
    \mathcal{J}(x_1(t) + x_2(t)) = \mathcal{J}(x_1(t)) + \mathcal{J}(x_2(t))
  $$
- **时变/时不变**
  - 判定：
  $$
    设\mathcal{J}表示一时不变系统，则：\\
    \mathcal{J}(x(t-t_0)) = \mathcal{J}(x(t))(t-t_0)
  $$
  - 口诀：时移的响应=响应的时移
- 因果/非因果
- 记忆/非记忆
- 稳定/不稳定
- 可逆/不可逆

## 卷积
卷积运算：
$$
    f[n] * g[n] = \sum_{k=-\infty}^{\infty} f[k] g[n-k]\\
    f(t) * g(t) = \int_{-\infty}^{\infty} f(\tau)g(t-\tau)\mathrm{d}\tau
$$

卷积运算的性质：
- 交换律
- 结合律（从交换律推出）
- 分配律
- 微分性质
  $$
    (x(t)*y(t))' = x'(t) * y(t) = x(t) * y'(t)
  $$

- 积分性质
  $$
    \int (x(t)*y(t)) = \int (x(t)) * y(t) = x(t)*\int y(t)
  $$

- 时不变
  $$
    若y(t) = x(t) * h(t)\\
    则y(t-t_0) = x(t-t_0)*h(t) = x(t)*h(t-t_0)
  $$
- 对离散情况同样有差分、求和和时不变

注意上述运算定律需要保证涉及的卷积和/卷积积分均收敛才成立

**卷积定理**：
$$
    设X(j\omega) = \mathcal{F}(x(t)), Y(j\omega) = \mathcal{F}(y(t))，则\\
    x(t) * y(t) = X(j\omega)Y(j\omega)\\
    X(j\omega)*Y(j\omega) = x(t)y(t)
$$



## LTI System
LTI(Linear Time Invarient) System 线性时不变系统

*单位脉冲响应*是指系统对单位脉冲信号输入的相应

**信号的线性分解：**

**任何信号都可以表示成时移单位脉冲信号的线性组合**，即：
$$
    x[n] = \sum_{k=-\infty}^{\infty} x[k] \delta[n-k]
$$

实际上，由卷积公式可知，上式等价于：
$$
    x[n] = x[n] * \delta[n]
$$

结合信号的线性分解、线性时不变系统的性质，有：

**线性时不变系统的响应公式：**
$$
    设h[n]表示系统单位脉冲响应\\
    系统对输入x[n]的响应y[n]有：\\
    y[n] = x[n] * h[n]\\
    同理连续情形下有：\\
    y(t) = x(t) * h(t)
$$

推论：**一个线性时不变系统可以由其单位脉冲响应完全表征**。因为这一个推论，又是会直接写出单位脉冲响应来代表一个LTI系统

写成泛函：
$$
    \mathcal{J}(x(t)) = x(t) * \mathcal{J}(\delta(t))
$$

线性时不变系统互联的性质（以$h_1(t), h_2(t)$为例）：
- 并联：$h_1(t) + h_2(t)$
- 级联（串联）：$h_1(t) * h_2(t)$

注意上述结论可以由卷积运算的性质得出

**从单位脉冲响应研究LTI的系统性质**
- 记忆性：
  
  当$h(t) = k\delta(t)$时LTI无记忆，否则是有记忆的

- 可逆性：
  
  LTI系统若可逆，则其逆系统也是LTI

  由LTI级联性质可知若$h(t),g(t)$系统互逆，则必有：

  $$
    h(t) * g(t) = \delta(t)
  $$

- 因果性：
  
  若$h(t)$满足$h(t)=0, t < 0$，则该LTI是因果的，否则是非因果的

  几何解释：把$h(t)$镜像反转，然后在$x(t)$上平移，发现当$t\ge 0$时$h(t)$的值就是对当前点过去和现在的加权累积的权值，相应的$t<0$时$h(t)$时“未来的权值”。未来的权值为0即与未来取值无关，即“因果的”

## 奇异函数
对$\delta(t)$的定义，无论是$\delta(t) = \frac{du(t)}{dt}$还是使得$\int \delta(t)dt = 1, \delta(t) = 0, t \ne 0$成立的函数，都在数学上“不够严密”

  比如说：
  $$
    \delta_{\Delta}(t) * \delta_{\Delta}(t)
  $$
  满足所有描述的性质

  因此，真正的$\delta(t)$的真正好的一个定义是**使用函数的卷积性质来定义函数**

  如$\delta(t)$定义为满足：
  $$
    x(t) = x(t) * \delta(t)
  $$
  的函数$\delta(t)$函数

  这样的函数我们称为*奇异函数*

  由$\delta(t)$的卷积定义，我们可以反过来推出$\delta(t)$的某些性质：

  $$
    x(0) = \int_{-\infty}^{+\infty} x(\tau)\delta(\tau)d\tau
  $$
  $$
    x(t)\delta(t) = x(0)\delta(t)
  $$
  $$
    \int_{-\infty}^{+\infty} \delta(t) dt = 1
  $$

  其中第一条性质也称为**单位冲激函数的积分定义**

  其中第二条性质也称为单位脉冲的*筛选性质*

### 其他奇异函数

  有了如上框架，我们可以定义$u_k(t)$:

  考虑一个LTI系统：微分器，也即：
  $$
    y(t) = \frac{dx(t)}{dt}
  $$

  则由LTI的特性，有：
  $$
    \frac{dx(t)}{dt} = x(t) * u_1(t)
  $$

  其中$u_1(t)$为一阶微分器的单位冲激响应

  一般称$u_1(t)$为*单位冲激偶*

  注意单位冲激偶是奇函数（笑）

  类似单位冲激，有如下$u_1(t)$的一些性质：
  $$
    -g'(0) = \int_{-\infty}^{+\infty} g(t) u_1(t) dt
  $$

  $$
    f(t)u_1(t) = f(0)u_1(t) - f'(0)\delta(t)
  $$

  $$
    \int_{-\infty}^{+\infty} u_1(t)dt = 0
  $$

  注意：
  - 第一条性质，**不要漏掉负号**
  - 第二条性质，公式的形式与$\delta(t)$的情形大不相同

  类似的，我们将$u_k(t), k>0$定义为$k$阶微分器的单位冲激响应

  相应可以给出$u_k(t)$的积分定义：
  $$
    (-1)^{k}g^{(k)}(0) = \int_{-\infty}^{+\infty}g(t) u_k(t) dt
  $$

  再有，积分器也是LTI，我们定义$u_{-k}(t),k>0$为$k$阶积分器的单位冲激响应

  一般$u_{-2}(t)$称为*单位斜坡函数*

  此外，$u(t), \delta(t)$可以写作$u_{-1}(t), u_0(t)$

## 傅里叶级数
### 复指数信号与傅里叶级数
使用傅里叶级数的动机有两部分：
1. LTI系统对复指数信号的响应具有简单的形式
2. 一大类常见的周期信号可以表示为复指数信号的线性组合

- LTI的复指数响应
  
  LTI对复指数信号$e^{st}$的响应有如下形式：

  $$
  \mathcal{L}(e^{st}) = H(s) e^{st}
  $$

  发现系统对信号的响应是该信号乘一个与$t$无关的，与$s$有关的常数

  其中，$s=a+bj$为复数

- 傅里叶级数
  
  一大类周期函数可以表示为如下无穷级数：

  $$
    x(t) = \sum_{k=-\infty}^{+\infty} a_k e^{jk\omega_0t}
  $$

  称为**傅里叶级数**

  其中，$j$是虚数单位，$\omega_0$是*基波频率*（其实就是最小正周期），$k\in Z$

  注意到傅里叶级数中的$e^{jk\omega_0t}$其实是指数实部为零的复指数信号

综合上述两个重要事实，我们发现LTI系统对信号的响应有如下形式：

考虑$h(t)$是LTI系统的单位冲激响应，且$x(t)$的傅里叶级数表示存在，且

$$
  H(j\omega) = \int_{-\infty}^{+\infty} h(t)e^{-j\omega_0 t} dt
$$

则系统响应有：
$$
  y(t) = \sum_{k=-\infty}^{+\infty}a_k H(jk\omega_0) e^{jk\omega_0 t}
$$

注意：

1. 上式中相当于$H(j\omega)$和级数$\sum_{k=-\infty}^{+\infty}e^{jk\omega_0 t}$逐点相乘。虽然不明显，但实际上与*卷积定理*有联系
   
   若将时域信号全部替换为频域信号（傅里叶变换），则上式可以写作：

   $$
    Y(j\omega) = H(j\omega)X(j\omega)
   $$

   即卷积定理

   **小心，相似但不能混淆，y(t)和$e^{j\omega t}$都是时域信号**

2. $H(j\omega)$称为**频率响应**。因为它其实是$h(t)$的傅里叶变换，这是**冲激响应的频率域表示**

### 傅里叶级数及其系数
**在连续情况下**，我们需要**无穷个成谐波关系**的复指数信号组成傅里叶级数的基底

**离散情况下**，我们只需要**有限个成谐波关系**的复指数信号即可构成一组基底
 
若傅里叶级数表示存在，则有如下公式表示傅里叶级数系数

**连续信号的傅里叶系数公式**
$$
  a_k = \frac{1}{T}\int_T x(t)e^{-jk\omega_0t}dt
$$

积分区间可以是任意一个基波周期

**离散信号的傅里叶系数公式**

$$
  a_k = \frac{1}{N}\sum_N x[n] e^{-jk\omega_0n}
$$

求和的区间可以是任意一个周期。但是，常用$0$到$N-1$，$N$为基波周期

可以看到，其实连续和离散的公式形式非常类似

Don't forget $1/T$, $1/N$


### 傅里叶级数存在的条件
充要条件很难找，但有两组充分条件
1. **平方可积条件**
   
   若$\int_{-\infty}^{+\infty}|x(t)|^2dt < \infty$（其实就是信号能量有限）

2. 迪利克雷条件
   
   三条：
   1. 绝对可积
   2. 任意有限区间，$x(t)$只有有限个极值点，且极值有限
   3. 任意有限区间，$x(t)$只有有限个间断点、且间断点上函数值有限

可以发现，某些具有有限个间断点的函数依然有傅里叶级数存在（比如周期方波），且傅里叶级数在间断点处依然有定义，但实际上在间断点附近的傅里叶级数的取值是怪异的（可能会反复震荡）。这种现象称为*吉布斯现象*

### 微分方程、差分方程表示的LTI的频率响应

某些满足条件的使用微分方程、差分方程表示的LTI可以使用傅里叶级数表示来简单地求解其频率响应（待完善）

## 傅里叶变换

### 概述
将周期信号上的傅里叶级数推广到非周期信号上的**傅里叶变换**：
$$
  X(j\omega) = \int_{-\infty}^{+\infty} x(t)e^{-j\omega t} dt
$$
和**傅里叶逆变换**：
$$
  x(t) = \frac{1}{2\pi} \int_{-\infty}^{+\infty} X(j\omega) e^{j\omega t} d\omega
$$

可以发现，由于形式的相似性，傅里叶变换的值和傅里叶级数系数有某种联系。傅里叶变换的函数值似乎是傅里叶级数系数的极限情形。

特别地，两者具有如下定量关系（周期函数）
$$
  a_k = \frac{1}{T}X(jk\omega_0)
$$

其中，$X(j\omega)$是周期函数在一个基波周期内的傅里叶变换

傅里叶变换的结果一般是个函数值为复数的复变函数，不好图示，所以常取两个量来图示：
- 复函数值的模关于输入$\omega$的图像。这个量称为*幅值*，这张图称为*频谱*
- 复函数值的相角

可以发现$\delta(t)$的傅里叶变换是恒等函数$X(j\omega)=1$

### 周期信号的傅里叶变换

按照基本的傅里叶变换的定义，傅里叶变换只适用于非周期信号。

但如下手法可以延拓傅里叶变换：

考虑$x(t) = 1$，作为周期信号，$x(t)$本来没有傅里叶变换。

但是，考虑$X(j\omega) = \delta(\omega)$的傅里叶逆变换：
$$
  x(t) = \frac{1}{2\pi} \int_{-\infty}^{+\infty}
  X(j\omega)e^{j\omega t} d\omega = \frac{1}{2\pi}
$$

等式变换得$\mathcal{F}(1) = 2\pi \delta(\omega)$

由此，我们**通过傅里叶逆变换构造**了周期函数$x(t) = 1$的傅里叶变换。我们规定这就是该周期函数的傅里叶变换。

类似的，我们由如下结论：
$$
  \mathcal{F}(e^{j\omega_0 t}) = 2\pi\delta(\omega - \omega_0)
$$

也即，形如$e^{j\omega_0 t}$的复指数周期信号的傅里叶变换就是移位脉冲。

根据**周期信号的傅里叶级数表示**以及**傅里叶变换的线性性**，一切周期函数都可以表示成复指数的无穷线性组合，则一切周期函数都可以有傅里叶变换表示：

$$
  x(t) = \sum_{k=-\infty}^{+\infty} a_k e^{jk\omega_0 t}\\
  \mathcal{F}(x(t)) = \sum_{k=-\infty}^{+\infty} a_k \mathcal{F}(e^{jk\omega_0 t})\\
   = 2\pi\sum_{k=-\infty}^{+\infty} a_k \delta(\omega - k\omega_0)
$$

以上就是**周期函数的傅里叶变换**

观察公式发现：周期信号的傅里叶变换实际上就是一组强度不等的冲激串。

进一步观察发现，由：
$$
  \mathcal{F}(e^{jk\omega_0 t}) = 2\pi\delta(\omega-\omega_0)
$$

以及傅里叶级数：
$$
  x(t) = \sum_{k=-\infty}^{\infty} a_k e^{jk\omega_0t}
$$

发现**其实所谓周期函数的傅里叶变换就是对周期函数的傅里叶级数做傅里叶变换**

### 阶跃函数的傅里叶变换
$$
  \mathcal{F}(u(t)) = \frac{1}{j\omega} + \pi \delta(\omega)
$$
（待完善）

### 连续傅里叶变换的性质

信号的时域表示和频域表示具有很强的联系，体现为诸多变换的相关性。

1. **线性**
   $$
    X(j\omega) = \mathcal{F}(x(t)) \\
    则\mathcal{F}(ax(t)+by(t)) = a\mathcal{F}(x(t)) + b\mathcal{F}(y(t))
   $$

2. **时移性质**：
   $$
      若X(j\omega) = \mathcal{F}(x(t))\\
      \mathcal{F}(x(t-t_0)) = X(j\omega)e^{j\omega t_0}
   $$

   注意**时域上的平移对应了频域上的旋转**，但幅值没有改变。也即**不影响幅频性质，只影响相频性质**


3. 共轭对称性
   
   $$
    若\mathcal{F}(x(t)) = X(j\omega)\\
    则\mathcal{F}(x^*(t)) = X^*(-j\omega)
   $$

   由此可以推导出以下一系列性质：

   若$x(t)$是**实信号**，$X(j\omega) = \mathcal{F}(x(t))$，则：
   $$
    Re[X(j\omega)]是偶函数\\
    Im[X(j\omega)]是奇函数\\
    |X(j\omega)|是偶函数\\
    \angle X(j\omega)是奇函数
   $$

   此外，有实函数的傅里叶变换也是实函数

4. 微分/积分性质
   
   微分性质：
   $$
    \frac{dx(t)}{dt} = j\omega X(j\omega)
   $$

   微分性质只需要对傅里叶逆变换的两端求导即可证

   *积分性质（了解）：
   $$
    \mathcal{F}\left(\int_{-\infty}^{t} x(\tau)d\tau\right) \\
    = \frac{1}{j\omega}X(j\omega) + \pi \delta(\omega) X(0)
   $$

   完整的证明需要利用积分交换次序。一个简易的说明是*卷积定理*：
   $$
    \int_{-\infty}^{t} x(\tau)d\tau = x(t) * u(t)\\
    = X(j\omega)(\frac{1}{j\omega}+ \pi \delta(\omega))
   $$
   
   用此法，知道$u(t)$的傅里叶变换，积分性质就立即得证了。

5. 尺度变换
   
   $$
    \mathcal{F}(x(at)) = \frac{1}{|a|}X(j\frac{\omega}{a})
   $$

   特别的，有*时域对称的频域公式*：
   $$
    x(-t) = X(-j\omega)
   $$

6. **对偶性**：
   
   **这一特性从根本上揭示了时域和频域的对称特性**。通俗地说，就是时域变换A对应频域变换B，而时域变换B对应与A类似的频域变换A'

   $$
      \mathcal{F}(x(t)) = X(j\omega)\\
      \mathcal{F}(X(j\omega)) = 2\pi x(-t)
   $$

   对偶性可以快速导出*移频特性*：
   $$
    \mathcal{F}(x(t)e^{j\omega_0 t}) = X(j(\omega-\omega_0))
   $$

   这一结论可以直接对通常可以直接得到的时域信号进行*移频调制*

   此外，对偶性可以辅助一些时域和频域上的性质的证明

7. Parseval定理（帕萨瓦定理）
   
   $$
    E[x(t)] = \frac{1}{2\pi} E[X(j\omega)]
   $$

   其中$E[\cdot]$表示信号的能量（不是期望）

### 卷积定理

$$
    设X(j\omega) = \mathcal{F}(x(t)), Y(j\omega) = \mathcal{F}(y(t))，则
$$

$$
    \mathcal{F}(x(t) * y(t)) = X(j\omega)Y(j\omega)
$$

由对偶性，立刻有：
$$
\mathcal{F}(X(j\omega)*Y(j\omega)) = x(t)y(t)
$$

$$
\mathcal{F}(s(t)p(t)) = \frac{1}{2\pi} S(j\omega)*P(j\omega)
$$

### LTI系统的频域分析

考虑LTI系统$h(t)$，

$$
  H(j\omega) = \mathcal{F}(h(t))
$$

称为LTI系统的**频率响应**

频率响应不一定存在，需要$h(t)$满足傅里叶变换存在的充分条件。一般常见的稳定系统都存在频率响应。

则：
$$
  y(t) = \mathcal{F}^{-1}(H(j\omega)X(j\omega))
$$

### 傅里叶变换应用：信号调制

调制：
$$
  y(t) = s(t)p(t)
$$
其中若$s(t)$是原始信号，乘以$p(t)$来改变信号的幅值的过程称为**调制**

移频特性：
$$
  \mathcal{F}(x(t)e^{j\omega_0 t}) = X(j(\omega-\omega_0))
$$

结合卷积定理，可以证明**使用正弦信号调制等效于在信号在频域上平移**

## 离散傅里叶变换

(待完善)

离散傅里叶变化相比连续情形,最大的区别其实是离散傅里叶变换的$X(e^{j\omega})$关于$\omega$具有周期

### 离散傅里叶变换的性质
(待完善)

- 差分:
  
  $$
    x[n] - x[n-1] = (1-e^{-j\omega})X(e^{j\omega})
  $$

  不同于微分的情形,实际上该公式可以直接从时移性质导出

### 卷积定理

相比连续情形,最显著的区别是时域乘积的傅里叶变换等于频域卷积.但是离散傅里叶变换的频域函数是周期的,故该"卷积"其实是*周期卷积*

## 傅里叶系列总结
（待完善）

## 频域分析应用

### 频率响应 & 信号失真
  
LTI频率响应$H(j\omega)$是一个复变函数，其特征难以感知和可视化。常对其做分解得到两组实函数：

1. $|H(j\omega)|$称为*幅频特性*
2. $\angle H(j\omega)$称为*相频特性*

实际上，无论对信号的幅度还是相位引入变化，都有可能导致信号波形的显著变化，我们称为*信号失真*

由LTI系统响应公式$Y(j\omega) = H(j\omega)X(j\omega)$有如下事实：
$$
  |Y(j\omega)| = |H(j\omega)||X(j\omega)|\\
  \angle Y(j\omega) = \angle H(j\omega) + \angle X(j\omega)
$$

如果要保证一个LTI系统不会导致系统失真，显然要求**频率响应的幅度为非零常数，相位为常数**。这样可以保证系统对输入的变换为：
1. **对输入信号的幅度做等幅缩放**
2. **对输入信号做时域平移**

以上两点变化都不会修改输入波的形状。因此**LTI系统不失真条件为**：
$$
  H(j\omega) = ke^{-jt_0\omega}
$$

### 滤波器
常见的几类滤波器：
- 低通滤波器
- 高通滤波器
- 带通滤波器
- 带阻滤波器
  
### Bode图
（待完善）

## 采样
所谓*采样*其实取连续信号的某些离散点上的信号值保存的过程

采样的两个核心问题
1. **什么条件下离散的采样样本可以恢复出原始的连续信号**
2. **怎样将从离散的采样样本中恢复出原始的连续信号**

理想的采样过程可以建模为连续信号$x(t)$乘上单位冲激串$h(t) = \sum \delta(t-kT)$

### Nyquist（奈奎斯特采样定理）

**奈奎斯特采样定理**：对于带限信号的理想采样，采样频率大于带限频率的两倍，则可以从样本中无损恢复出连续原始信号。

简要证明如下：

令$h(t) = \sum_k \delta(t-kT)$
$$
  s(t) = x(t)h(t) \leftrightarrow S(j\omega) = \frac{1}{2\pi}X(j\omega) * H(j\omega)
$$

注意冲激串的傅里叶变换仍然是冲激串。

则由卷积的线性和单位冲激的筛选性有：
$$
  S(j\omega) = \sum_{k=-\infty}^{+\infty} X(j(\omega - \omega_s))
$$

其中$\omega_s$是采样平吕

观察发现，$S(j\omega)$实质上是原始信号$X(j\omega)$频谱平移之后加起来得到一个**原始信号频谱的周期重复**。观察发现，若满足$\omega_M > 2\omega_s$（$\omega_M$为带限信号的截止频率），则这信号频谱周期重复时不会相互重叠。由于只有平移和一个常数的缩小，故频谱形状完全没变，使用一个低通滤波器即可从$S(j\omega)$中滤出一个基波周期，从而得到原始信号的频谱。从而得到原始信号。